const db = require('../db-connecter.js');

const dbInstnace = db.getDbInstance();
const vulInfo = dbInstnace.use('vulnerabilities_info');

const getVulDetailData = (req, res) => {
  console.log(req.params.name);
  vulInfo.find({
    selector: {
      Name: { $eq: req.params.name }
    }
  }, (err, data) => {
    if (err) {
      res.status(err.statusCode).json(
        {
          success: false,
          error: err
        }
      );
    } else {
      res.status(200).json(
        {
          success: true,
          data: data.docs[0]
        }
      );
    }
  });
};

module.exports = {
  getVulDetailData
}
